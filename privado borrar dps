<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>InnovateHub Pro ‚Äì Portal Digital</title>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:700,600,500,400|Inter:400,500" rel="stylesheet">
  <style>
    :root {
      --bg: #f3f6fa;
      --surface: #fcfcfe;
      --purple: #8989f7;
      --deep-purple: #6156e3;
      --coral: #fe8a71;
      --yellow: #ffd363;
      --mint: #6ef4c6;
      --lavender: #e6ecfa;
      --text: #142144;
      --muted: #637089;
      --sidebar: #ece9fc;
      --badge: #6156e3;
      --badge2: #fe8a71;
      --orange-shadow: 0 18px 55px 4px #fe8a71e3;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
    }
    [data-theme="dark"] {
      --bg: #0f1419;
      --surface: #1a1f2e;
      --text: #e1e7f5;
      --muted: #8b92a8;
      --sidebar: #151b28;
      --lavender: #1e2535;
    }
    * { box-sizing: border-box; }
    html, body {
      font-family: 'Montserrat', 'Inter', Arial, sans-serif;
      margin: 0; padding: 0; background: var(--bg); color: var(--text); min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }
    body { display: flex; width: 100vw; overflow-x: hidden;}
    
    /* SIDEBAR */
    .sidebar {
      min-width: 70px; width: 80px; background: var(--sidebar); height: 100vh;
      display: flex; flex-direction: column; align-items: center; box-shadow: 2px 0 20px #bdb7fa23; z-index:99; position:fixed; left:0;top:0;
      transition: background 0.3s;
    }
    .side-logo {
      margin: 1rem 0 2.0rem 0;
      background: linear-gradient(120deg, var(--purple) 50%, var(--coral));
      color: var(--surface);
      border-radius: 50%; width: 48px; height: 48px;
      display: flex; align-items: center; justify-content: center;
      font-weight: 900; font-size: 1.55rem;
      box-shadow: 0 1px 12px #8989f773;
      cursor: pointer;
      position: relative;
    }
    .notification-badge {
      position: absolute;
      top: -4px;
      right: -4px;
      background: var(--danger);
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 0.7rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    .side-menu {display:flex; flex-direction: column; gap: 1.85rem; width:100%; flex: 1;}
    .side-menu button {
      width: 48px; height: 48px; margin: 0 auto;
      border-radius: 50%; border: none; background: none;
      color: var(--deep-purple); font-size: 1.45rem;
      display: flex; align-items: center; justify-content: center;
      transition:.18s; cursor:pointer;
      position: relative;
    }
    .side-menu button.active, .side-menu button:hover {
      background: var(--lavender); color: var(--coral); box-shadow: 0 2px 38px #fe8a71e6;
    }
    .side-menu button .badge-count {
      position: absolute;
      top: 2px;
      right: 2px;
      background: var(--coral);
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 0.65rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
    }
    
    /* Theme Toggle */
    .theme-toggle {
      width: 48px;
      height: 48px;
      margin: 0 auto 1rem;
      border-radius: 50%;
      border: none;
      background: var(--lavender);
      color: var(--deep-purple);
      font-size: 1.3rem;
      cursor: pointer;
      transition: 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .theme-toggle:hover {
      background: var(--purple);
      color: white;
      transform: rotate(180deg);
    }
    
    .side-footer {margin: 1.9rem 0 2rem 0; font-size:.82rem; color: var(--muted); opacity:.6; text-align: center;}
    .main-container {margin-left: 80px; width:100vw; flex:1; min-width: 0; padding-bottom:5rem;}
    
    /* TOPNAV */
    .topnav {
      height: 70px; background: var(--surface); display: flex; align-items: center; justify-content: space-between; box-shadow: 0 1px 14px #dbe5fc22;
      padding: 0 2.3rem; position:sticky;top:0;z-index:30; transition: background 0.3s;
    }
    .topnav-title {
      font-size: 1.27rem; font-weight:900; color: var(--deep-purple); letter-spacing:.6px;
      background: linear-gradient(120deg, var(--deep-purple), var(--coral) 70%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .topnav-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .searchbar {
      background: var(--lavender); border-radius: 25px; display: flex; align-items: center;
      padding: .37rem 1.3rem; font-size:.99rem; box-shadow:0 2px 14px #8989f712;
      transition: background 0.3s;
      position: relative;
    }
    .searchbar input {border: none; outline: none; background: none; margin-left: 0.55rem; font-size:1rem;color: var(--text); width: 200px;}
    .searchbar input::placeholder { color: var(--muted); }
    
    /* Search Suggestions */
    .search-suggestions {
        display: none;
        position: absolute;
        top: 110%;
        left: 0;
        width: 100%;
        background: var(--surface);
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        z-index: 100;
        max-height: 300px;
        overflow-y: auto;
    }
    .search-suggestions.active {
        display: block;
    }
    .suggestion-item {
        padding: 0.8rem 1.2rem;
        font-size: 0.95rem;
        color: var(--muted);
        cursor: pointer;
        border-bottom: 1px solid var(--lavender);
    }
    .suggestion-item:last-child {
        border-bottom: none;
    }
    .suggestion-item:hover {
        background: var(--lavender);
        color: var(--deep-purple);
    }
    .suggestion-item strong {
        color: var(--text);
    }

    /* Filter Buttons */
    .filter-container {
      display: flex;
      gap: 0.5rem;
      margin-left: 1rem;
    }
    .filter-btn {
      padding: 0.4rem 1rem;
      border-radius: 20px;
      border: 2px solid var(--lavender);
      background: transparent;
      color: var(--deep-purple);
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: 0.2s;
    }
    .filter-btn:hover, .filter-btn.active {
      background: var(--deep-purple);
      color: white;
      border-color: var(--deep-purple);
    }
    
    .icon-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background: var(--lavender);
      color: var(--deep-purple);
      font-size: 1.2rem;
      cursor: pointer;
      transition: 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .icon-btn:hover {
      background: var(--deep-purple);
      color: white;
      transform: scale(1.05);
    }
    .icon-btn .badge-dot {
      position: absolute;
      top: 5px;
      right: 5px;
      width: 8px;
      height: 8px;
      background: var(--danger);
      border-radius: 50%;
    }
    
    .avatar {
      width: 38px; height: 38px; background: var(--mint); border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight:800;font-size:1.07rem;color:var(--deep-purple); letter-spacing:.3px;
      box-shadow:0 1px 6px #6ef4c643; cursor:pointer;
    }
    
    .main-columns {display: flex; flex-direction: row; gap: 2.2rem; padding:2rem 2rem 1.8rem 2rem; max-width:1670px;margin:auto;}
    .main-left { flex:2.03; min-width: 365px;}
    .main-right {flex:1; min-width: 290px;max-width:420px;}
    @media (max-width: 1100px){ .main-columns{flex-direction:column;gap:1.4rem;} .main-right{max-width:unset;}}
    @media (max-width:800px){.main-columns{padding:1rem .3rem;}}
    
    /* NEWS HERO */
    .news-hero {
      background: linear-gradient(90deg, var(--lavender) 60%, var(--mint) 100%);
      border-radius: 21px; padding: 2.2rem 2.1rem 1.7rem 2.2rem; margin-bottom: 1.1rem;
      box-shadow:0 3px 28px #cbe8fa19;
      display: flex;flex-direction:row;gap:2rem; align-items:center; min-height:210px; position:relative; overflow:hidden;
      transition: background 0.3s;
    }
    .news-hero-image {width: 180px; height: 114px; border-radius: 15px; object-fit: cover; background: #f4f5fd; box-shadow:0 2px 10px #8989f733; flex-shrink:0;}
    .news-hero-content {flex:1;}
    .news-hero-badge {
      background: var(--badge2); color: var(--surface); padding: .29rem .9rem; border-radius: 13px;
      font-weight: 700; font-size:.95rem; margin-bottom:.55rem; display:inline-block;letter-spacing:.09px;
    }
    .news-hero-title {font-size: 1.41rem;font-weight:900;margin:.15rem 0 .72rem;}
    .news-hero-desc {color: var(--muted);font-size:.98rem;}
    
    /* Refresh Button */
    .refresh-news-btn {
      position: absolute;
      top: 1rem;
      right: 1rem;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      border: none;
      background: var(--coral);
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: 0.2s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }
    .refresh-news-btn:hover {
      background: var(--deep-purple);
      transform: scale(1.05);
    }
    .refresh-news-btn.loading .refresh-icon {
      animation: spin 1s linear infinite;
    }
    .refresh-news-btn .refresh-text {
      display: inline;
    }
    .refresh-news-btn.loading .refresh-text {
      display: none;
    }
    
    @keyframes spin {
      100% { transform: rotate(360deg); }
    }
    
    /* NEWS LIST */
    .news-list {display:grid;grid-template-columns:1fr 1fr;gap:1.4rem; margin-bottom:2.1rem;}
    .news-card {
      background: var(--surface);
      border-radius: 17px; box-shadow:0 1px 14px #bdb7fa19;
      padding:1.2rem 1rem 1.1rem 1.2rem; display:flex;gap:1rem;
      cursor:pointer; position:relative; overflow:hidden;transition:.17s;
      min-height:96px;
    }
    .news-card:hover { box-shadow: var(--orange-shadow), 0 3px 18px #fe8a7138; transform: translateY(-2px);}
    .news-card-image {width:65px;height:65px;border-radius: 10px; object-fit:cover;background: #ecf0f6;flex-shrink:0;}
    .news-card-main{flex:1;}
    .news-card-badge { font-size:.89rem; font-weight:700; color: var(--surface); background: var(--badge); display:inline-block; padding: .19rem .7rem; border-radius:9px; margin-bottom:.35rem;}
    .news-card-title {font-weight:700;font-size:.96rem;margin-bottom:0.32rem;}
    .news-card-desc {color: var(--muted);font-size:.92rem;}
    .news-card-link { color: var(--deep-purple); font-weight:600; text-decoration:none;}
    .news-card-link:hover {text-decoration:underline;}
    
    /* Favorite Button */
    .fav-btn {
      position: absolute;
      top: 0.8rem;
      right: 0.8rem;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: var(--lavender);
      color: var(--muted);
      font-size: 1.1rem;
      cursor: pointer;
      transition: 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      z-index: 5; /* Asegurarse que est√© sobre la card */
    }
    .news-card:hover .fav-btn {
      opacity: 1;
    }
    .fav-btn:hover, .fav-btn.active {
      background: var(--coral);
      color: white;
      transform: scale(1.15);
    }
    
    /* DASHBOARD PANEL */
    .dash-panel { margin-top:2.4rem;display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;}
    .panel-card {
      background: var(--surface);  
      border-radius: 18px; min-height:85px; display:flex;flex-direction:column;align-items:center;justify-content:center;
      color:var(--deep-purple);font-size:1.09rem;font-weight:700;letter-spacing:.2px;
      box-shadow:0 7px 38px #fe8a71a7, 0 2px 25px #fe8a71cd;
      cursor:pointer; transition:.14s;
    }
    .panel-card:hover{box-shadow: var(--orange-shadow), 0 2px 30px #fe8a71dc;background:var(--lavender);transform: translateY(-3px);}
    .panel-card-icon{font-size:2.0rem;margin-bottom:.38rem;}
    
    /* PROGRESS DASHBOARD */
    .progress-dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }
    .progress-card {
      background: var(--surface);
      border-radius: 15px;
      padding: 1.5rem;
      box-shadow: 0 2px 20px rgba(0,0,0,0.08);
      transition: 0.3s;
    }
    .progress-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 30px rgba(0,0,0,0.15);
    }
    .progress-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    .progress-card-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--deep-purple);
    }
    .progress-card-value {
      font-size: 2rem;
      font-weight: 900;
      background: linear-gradient(120deg, var(--purple), var(--coral));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .progress-bar-container {
      width: 100%;
      height: 8px;
      background: var(--lavender);
      border-radius: 10px;
      overflow: hidden;
      margin: 0.5rem 0;
    }
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--purple), var(--coral));
      border-radius: 10px;
      transition: width 0.5s ease;
    }
    
    /* BADGES/ACHIEVEMENTS */
    .badges-container {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin: 1.5rem 0;
    }
    .badge-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 1rem;
      background: var(--surface);
      border-radius: 12px;
      box-shadow: 0 2px 15px rgba(0,0,0,0.08);
      min-width: 100px;
      transition: 0.3s;
    }
    .badge-item:hover {
      transform: scale(1.05);
    }
    .badge-item.locked {
      opacity: 0.4;
      filter: grayscale(1);
    }
    .badge-icon {
      font-size: 3rem;
      margin-bottom: 0.5rem;
    }
    .badge-name {
      font-size: 0.85rem;
      font-weight: 600;
      text-align: center;
      color: var(--text);
    }
    .badge-desc {
      font-size: 0.75rem;
      color: var(--muted);
      text-align: center;
      margin-top: 0.3rem;
    }
    
    /* CALENDAR */
    .calendar-container {
      background: var(--surface);
      border-radius: 15px;
      padding: 1.5rem;
      box-shadow: 0 2px 20px rgba(0,0,0,0.08);
      margin: 1.5rem 0;
    }
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .calendar-title {
      font-size: 1.3rem;
      font-weight: 800;
      color: var(--deep-purple);
    }
    .calendar-nav {
      display: flex;
      gap: 0.5rem;
    }
    .calendar-nav button {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: none;
      background: var(--lavender);
      color: var(--deep-purple);
      cursor: pointer;
      transition: 0.2s;
      font-weight: 700;
    }
    .calendar-nav button:hover {
      background: var(--deep-purple);
      color: white;
    }
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.5rem;
    }
    .calendar-day-header {
      text-align: center;
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--muted);
      margin-bottom: 0.5rem;
    }
    .calendar-day {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: 0.2s;
      position: relative;
    }
    .calendar-day.empty {
        cursor: default;
        opacity: 0.3;
    }
    .calendar-day:not(.empty):hover {
      background: var(--lavender);
    }
    .calendar-day.today {
      background: var(--coral);
      color: white;
    }
    .calendar-day.has-event::after {
      content: '';
      position: absolute;
      bottom: 5px;
      width: 5px;
      height: 5px;
      background: var(--mint);
      border-radius: 50%;
    }
    .calendar-day.today.has-event::after {
      background: var(--surface);
    }
    .event-list {
      margin-top: 1.5rem;
      border-top: 2px solid var(--lavender);
      padding-top: 1rem;
    }
    .event-item {
      padding: 1rem;
      background: var(--lavender);
      border-radius: 10px;
      margin-bottom: 0.8rem;
      border-left: 4px solid var(--coral);
    }
    .event-title {
      font-weight: 700;
      color: var(--deep-purple);
      margin-bottom: 0.3rem;
    }
    .event-time {
      font-size: 0.85rem;
      color: var(--muted);
    }
    
    /* WIDGETS */
    .widget-cta-box {
      margin-bottom:1.1rem;background:var(--lavender);border-radius:14px;padding:1.17rem 1rem 1.07rem 1.17rem;
      box-shadow:0 2px 18px #e6ecfa33; color:var(--text); transition: background 0.3s;
    }
    .widget-cta-title{font-size:1.03rem;font-weight:700;color:var(--deep-purple);}
    .widget-cta-desc{font-size:.97rem;color:var(--muted);}
    .widget-btn {background:var(--coral);color:white;padding:.56rem 1.13rem;font-size:1.01rem;font-weight:700;
         border:none;border-radius:19px;cursor:pointer;transition:.13s;display:inline-block;margin:1rem auto .2rem;}
    .widget-btn:hover{background:var(--deep-purple); transform: scale(1.05);}
    .widget {
      background:var(--surface); border-radius:15px; box-shadow:0 1px 12px #bdd7fa28; padding:1.4rem 1.25rem 1.12rem 1.45rem; margin-bottom:1.3rem;
      transition:box-shadow .15s, background 0.3s;
    }
    .widget:hover {
      box-shadow: 0 3px 20px rgba(0,0,0,0.12);
    }
    .widget-title {font-size:1.08rem;font-weight:800;color:var(--deep-purple);margin-bottom:.6rem;}
    .widget-list {padding:0;margin:0;list-style:none;}
    .widget-list li{padding:.18rem 0;}
    .widget-list a{color:var(--coral);text-decoration:none;font-weight:500;}
    .widget-list a:hover{color:var(--deep-purple);}
    
    /* CHAT BOT */
    .chat-fab {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--purple), var(--coral));
      color: white;
      border: none;
      font-size: 1.8rem;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      transition: 0.3s;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .chat-fab:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 30px rgba(0,0,0,0.4);
    }
    .chat-window {
      position: fixed;
      bottom: 6rem;
      right: 2rem;
      width: 380px;
      height: 550px;
      background: var(--surface);
      border-radius: 20px;
      box-shadow: 0 10px 50px rgba(0,0,0,0.3);
      display: none;
      flex-direction: column;
      z-index: 999;
      overflow: hidden;
      transition: background 0.3s;
      transform: scale(0.5);
      opacity: 0;
      transform-origin: bottom right;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }
    .chat-window.open {
      display: flex;
      transform: scale(1);
      opacity: 1;
    }
    .chat-header {
      background: linear-gradient(135deg, var(--purple), var(--coral));
      color: white;
      padding: 1.2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .chat-header h3 {
      margin: 0;
      font-size: 1.1rem;
    }
    .chat-close {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .chat-message {
      max-width: 80%;
      padding: 0.8rem 1rem;
      border-radius: 15px;
      font-size: 0.95rem;
      line-height: 1.4;
      animation: popIn 0.3s ease;
    }
    @keyframes popIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .chat-message.bot {
      background: var(--lavender);
      color: var(--text);
      align-self: flex-start;
      border-bottom-left-radius: 5px;
    }
    .chat-message.user {
      background: var(--coral);
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 5px;
    }
    .chat-message.bot.thinking {
      display: flex;
      gap: 5px;
      align-items: center;
    }
    .chat-message.bot.thinking span {
      width: 8px;
      height: 8px;
      background: var(--muted);
      border-radius: 50%;
      animation: typing 1s infinite;
    }
    .chat-message.bot.thinking span:nth-child(1) { animation-delay: 0s; }
    .chat-message.bot.thinking span:nth-child(2) { animation-delay: 0.2s; }
    .chat-message.bot.thinking span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes typing {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }
    .chat-input-container {
      padding: 1rem;
      border-top: 2px solid var(--lavender);
      display: flex;
      gap: 0.8rem;
    }
    .chat-input {
      flex: 1;
      padding: 0.8rem;
      border: 2px solid var(--lavender);
      border-radius: 20px;
      outline: none;
      font-size: 0.95rem;
      background: var(--bg);
      color: var(--text);
    }
    .chat-send {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      border: none;
      background: var(--coral);
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      transition: 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .chat-send:hover {
      background: var(--deep-purple);
      transform: scale(1.05);
    }
    
    /* MODAL */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    .modal.open {
      display: flex;
    }
    .modal-content {
      background: var(--surface);
      border-radius: 20px;
      padding: 2rem;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
      box-shadow: 0 20px 60px rgba(0,0,0,0.4);
    }
    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 2rem;
      cursor: pointer;
      color: var(--muted);
      transition: 0.2s;
    }
    .modal-close:hover {
      color: var(--coral);
      transform: rotate(90deg);
    }
    .modal-title {
      font-size: 1.8rem;
      font-weight: 900;
      color: var(--deep-purple);
      margin-bottom: 1.5rem;
    }
    
    /* TOAST NOTIFICATIONS */
    .toast-container {
      position: fixed;
      top: 5rem;
      right: 2rem;
      z-index: 3000;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .toast {
      background: var(--surface);
      padding: 1rem 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      gap: 1rem;
      min-width: 300px;
      animation: slideIn 0.3s ease;
      border-left: 4px solid var(--success);
    }
    .toast.success { border-left-color: var(--success); }
    .toast.warning { border-left-color: var(--warning); }
    .toast.error { border-left-color: var(--danger); }
    .toast-icon {
      font-size: 1.5rem;
    }
    .toast-content {
      flex: 1;
    }
    .toast-title {
      font-weight: 700;
      margin-bottom: 0.2rem;
    }
    .toast-message {
      font-size: 0.9rem;
      color: var(--muted);
    }
    .toast-close {
      background: none;
      border: none;
      font-size: 1.3rem;
      cursor: pointer;
      color: var(--muted);
    }
    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    .toast.fadeOut {
        animation: fadeOut 0.5s ease forwards;
    }
    @keyframes fadeOut {
        from {
            opacity: 1;
            transform: translateX(0);
        }
        to {
            opacity: 0;
            transform: translateX(400px);
        }
    }
    
    /* LOADING SPINNER */
    .loading-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 4000;
      align-items: center;
      justify-content: center;
    }
    .loading-overlay.active {
      display: flex;
    }
    .spinner {
      width: 60px;
      height: 60px;
      border: 5px solid var(--lavender);
      border-top-color: var(--coral);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    /* ANALYTICS CHARTS */
    .chart-container {
      background: var(--surface);
      border-radius: 15px;
      padding: 1.5rem;
      box-shadow: 0 2px 20px rgba(0,0,0,0.08);
      margin: 1.5rem 0;
    }
    .chart-title {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--deep-purple);
      margin-bottom: 1rem;
    }
    .chart-bars {
      display: flex;
      align-items: flex-end;
      gap: 1rem;
      height: 200px;
      padding: 1rem 0;
      border-bottom: 2px solid var(--lavender);
      padding-bottom: 2rem;
    }
    .chart-bar {
      flex: 1;
      background: linear-gradient(to top, var(--purple), var(--coral));
      border-radius: 8px 8px 0 0;
      position: relative;
      transition: 0.3s;
      cursor: pointer;
    }
    .chart-bar:hover {
      opacity: 0.8;
      transform: scaleY(1.05);
    }
    .chart-bar-label {
      position: absolute;
      bottom: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.8rem;
      color: var(--muted);
      white-space: nowrap;
    }
    .chart-bar-value {
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--deep-purple);
      opacity: 0;
      transition: opacity 0.2s;
    }
    .chart-bar:hover .chart-bar-value {
        opacity: 1;
    }

    /* Placeholder Panes */
    .placeholder-pane {
        padding: 2rem;
        text-align: center;
    }
    .placeholder-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
    }
    .placeholder-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--deep-purple);
        margin-bottom: 0.5rem;
    }
    .placeholder-text {
        font-size: 1rem;
        color: var(--muted);
        max-width: 400px;
        margin: 0 auto;
    }

    /* RESPONSIVE */
    @media (max-width:920px){.news-list{grid-template-columns:1fr;}}
    @media (max-width:700px){
      .main-container{margin-left:0;}
      .sidebar{position:fixed;bottom:0;left:0;flex-direction:row;height:65px;width:100vw;min-width:0;padding:0 1rem;justify-content:space-between; z-index: 100;}
      .side-menu{flex-direction:row;gap:0.5rem;}
      .main-columns{padding:.7rem; padding-bottom: 80px; /* Space for bottom bar */}
      .dash-panel{grid-template-columns:1fr 1fr;}
      .topnav{padding:0 .7rem;}
      .side-logo{margin:0;}
      .theme-toggle{margin:0;}
      .side-footer{display:none;}
      .chat-window{width:100%;height:100%;bottom:0;right:0;border-radius:0;}
      .chat-fab{bottom: 5rem; right: 1rem;}
      .filter-container{display:none;}
      .toast-container { top: 1rem; right: 1rem; left: 1rem; width: auto; }
    }
    @media (max-width:510px){
      .dash-panel,.news-list{grid-template-columns:1fr;}
      .news-hero{flex-direction:column;gap:1rem;}
      .main-columns{gap:.5rem;}
      .searchbar input{width:120px;}
    }
  </style>
</head>
<body>
  <div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
  </div>

  <div class="toast-container" id="toastContainer"></div>

  <div class="modal" id="mainModal">
      <div class="modal-content">
          <button class="modal-close" onclick="closeModal()">√ó</button>
          <h2 class="modal-title" id="modalTitle">Notificaciones</h2>
          <div id="modalBody">
              <p>Aqu√≠ se mostrar√° el contenido del modal, como la lista de notificaciones.</p>
              <div class="event-item" style="border-left-color: var(--success);">
                  <div class="event-title">¬°Nuevo curso disponible!</div>
                  <div class="event-time">Introducci√≥n a la IA Generativa.</div>
              </div>
              <div class="event-item" style="border-left-color: var(--warning);">
                  <div class="event-title">Webinar Ma√±ana</div>
                  <div class="event-time">Taller de Copilot - 10:00 AM.</div>
              </div>
          </div>
      </div>
  </div>

  <div class="sidebar">
    <div class="side-logo" onclick="nav('home')" title="InnovateHub">
      IH
      <span class="notification-badge" id="notificationBadge" style="display:none;">2</span>
    </div>
    <div class="side-menu">
      <button id="btn-home" class="active" onclick="nav('home')" title="Inicio">
        <span>üè†</span>
      </button>
      <button id="btn-dashboard" onclick="nav('dashboard')" title="Mi Progreso">
        <span>üìä</span>
      </button>
      <button id="btn-academy" onclick="nav('academy')" title="Cursos">
        <span>üéì</span>
      </button>
      <button id="btn-tools" onclick="nav('tools')" title="Herramientas IA">
        <span>ü§ñ</span>
      </button>
      <button id="btn-news" onclick="nav('news')" title="Noticias">
        <span>üì∞</span>
        <span class="badge-count" id="newsCount" style="display:none;">0</span>
      </button>
      <button id="btn-favorites" onclick="nav('favorites')" title="Favoritos">
        <span>‚≠ê</span>
        <span class="badge-count" id="favCount" style="display:none;">0</span>
      </button>
      <button id="btn-calendar" onclick="nav('calendar')" title="Calendario">
        <span>üìÖ</span>
      </button>
      <button id="btn-profile" onclick="nav('profile')" title="Perfil">
        <span>üë§</span>
      </button>
    </div>
    <button class="theme-toggle" id="themeToggle" title="Cambiar tema">
      <span id="themeIcon">üåô</span>
    </button>
    <div class="side-footer">
      InnovateHub <br>Pro 2024
    </div>
  </div>

  <div class="main-container">
    <div class="topnav">
      <span class="topnav-title" id="topnavTitle">Inicio</span>
      <div class="topnav-right">
        <div class="searchbar">
          <span>üîé</span>
          <input type="search" id="mainSearch" placeholder="Buscar en portal...">
          <div class="search-suggestions" id="searchSuggestions"></div>
        </div>
        <div class="filter-container" id="filterContainer" style="display:none;">
          <button class="filter-btn active" data-filter="all">Todos</button>
          <button class="filter-btn" data-filter="IA">IA</button>
          <button class="filter-btn" data-filter="ESPA√ëA">Espa√±a</button>
          <button class="filter-btn" data-filter="PYMES">Pymes</button>
        </div>
        <button class="icon-btn" id="notificationButton" title="Notificaciones">
          <span>üîî</span>
          <span class="badge-dot" id="notifDot" style="display:none;"></span>
        </button>
        <div class="avatar" id="avatar" onclick="nav('profile')">IU</div>
      </div>
    </div>

    <div class="main-columns">
      <div class="main-left">
        <div id="home-pane" class="page-pane">
          <div class="news-hero">
            <img class="news-hero-image" src="https://images.unsplash.com/photo-1677756128486-a83a04a52f9f?q=80&w=600" alt="digital workspace"/>
            <div class="news-hero-content">
              <div class="news-hero-badge">DESTACADO</div>
              <div class="news-hero-title">Transforma tu √°rea con IA y digitalizaci√≥n</div>
              <div class="news-hero-desc">Descubre c√≥mo la automatizaci√≥n y la formaci√≥n digital pueden cambiar tu d√≠a a d√≠a en el trabajo.</div>
            </div>
          </div>
          <div class="news-list" id="homeNewsList">
              </div>
          <div class="dash-panel">
            <div class="panel-card" onclick="nav('dashboard')" title="Mi progreso">
              <div class="panel-card-icon">üìä</div> Mi Progreso
            </div>
            <div class="panel-card" onclick="nav('academy')" title="Ir a cursos">
              <div class="panel-card-icon">üéì</div> Cursos
            </div>
            <div class="panel-card" onclick="nav('tools')" title="Herramientas IA">
              <div class="panel-card-icon">ü§ñ</div> Herramientas
            </div>
          </div>
        </div>

        <div id="dashboard-pane" class="page-pane" style="display:none">
          <div class="news-hero" style="background:linear-gradient(100deg,var(--mint) 60%,var(--purple) 100%)">
            <div class="news-hero-content">
              <div class="news-hero-badge" style="background:var(--deep-purple)">MI PROGRESO</div>
              <div class="news-hero-title">Tu evoluci√≥n digital en tiempo real</div>
              <div class="news-hero-desc">Visualiza tus logros, puntos y progreso en formaci√≥n. ¬°Sigue avanzando!</div>
            </div>
          </div>

          <div class="progress-dashboard">
            <div class="progress-card">
              <div class="progress-card-header">
                <span class="progress-card-title">üéØ Puntos Totales</span>
                <span class="progress-card-value" id="totalPoints">0</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar" id="pointsBar" style="width: 0%"></div>
              </div>
              <p style="font-size:0.85rem;color:var(--muted);margin-top:0.5rem;">Objetivo: 1000 puntos</p>
            </div>

            <div class="progress-card">
              <div class="progress-card-header">
                <span class="progress-card-title">üìö Cursos Completados</span>
                <span class="progress-card-value" id="coursesCompleted">0</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar" id="coursesBar" style="width: 0%"></div>
              </div>
              <p style="font-size:0.85rem;color:var(--muted);margin-top:0.5rem;">Meta: 10 cursos</p>
            </div>

            <div class="progress-card">
              <div class="progress-card-header">
                <span class="progress-card-title">‚è±Ô∏è Horas de Formaci√≥n</span>
                <span class="progress-card-value" id="hoursLearning">0</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar" id="hoursBar" style="width: 0%"></div>
              </div>
              <p style="font-size:0.85rem;color:var(--muted);margin-top:0.5rem;">Objetivo: 50 horas</p>
            </div>

            <div class="progress-card">
              <div class="progress-card-header">
                <span class="progress-card-title">üî• Racha Actual</span>
                <span class="progress-card-value" id="currentStreak">0</span>
              </div>
              <p style="font-size:0.85rem;color:var(--muted);margin-top:0.5rem;">¬°D√≠as consecutivos activo!</p>
            </div>
          </div>

          <div class="chart-container">
              <div class="chart-title">üìà Tiempo Invertido (√öltimos 7 d√≠as)</div>
              <div class="chart-bars" id="analyticsChart">
                  </div>
          </div>
        </div>

        <div id="academy-pane" class="page-pane" style="display:none">
            <div class="placeholder-pane">
                <span class="placeholder-icon">üéì</span>
                <h2 class="placeholder-title">Academia de Cursos</h2>
                <p class="placeholder-text">Aqu√≠ se mostrar√° el cat√°logo de cursos, tus rutas de aprendizaje y formaciones recomendadas.</p>
            </div>
        </div>
        <div id="tools-pane" class="page-pane" style="display:none">
            <div class="placeholder-pane">
                <span class="placeholder-icon">ü§ñ</span>
                <h2 class="placeholder-title">Herramientas IA</h2>
                <p class="placeholder-text">Un repositorio de herramientas de IA aprobadas, gu√≠as de uso y mejores pr√°cticas para tu trabajo.</p>
            </div>
        </div>
        <div id="news-pane" class="page-pane" style="display:none">
          <div class="news-hero">
            <img class="news-hero-image" src="https://images.unsplash.com/photo-1504711434969-e33886168f5c?q=80&w=600" alt="news"/>
            <div class="news-hero-content">
              <div class="news-hero-badge" style="background:var(--purple)">NOTICIAS</div>
              <div class="news-hero-title">Toda la actualidad digital</div>
              <div class="news-hero-desc">Filtra y descubre las √∫ltimas noticias sobre IA, transformaci√≥n y tecnolog√≠a en Espa√±a.</div>
            </div>
             <button class="refresh-news-btn" id="refreshNewsBig">
                <span class="refresh-icon">üîÑ</span>
                <span class="refresh-text">Actualizar</span>
            </button>
          </div>
           <div class="news-list" id="allNewsList" style="grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                </div>
        </div>
        <div id="favorites-pane" class="page-pane" style="display:none">
            <div class="placeholder-pane">
                <span class="placeholder-icon">‚≠ê</span>
                <h2 class="placeholder-title">Mis Guardados</h2>
                <p class="placeholder-text">Aqu√≠ aparecer√°n todas las noticias, cursos y herramientas que hayas marcado como favoritos.</p>
            </div>
        </div>
        <div id="calendar-pane" class="page-pane" style="display:none">
            <div class="calendar-container">
              <div class="calendar-header">
                <span class="calendar-title" id="calendarTitle">Octubre 2024</span>
                <div class="calendar-nav">
                  <button id="calPrev">‚Äπ</button>
                  <button id="calNext">‚Ä∫</button>
                </div>
              </div>
              <div class="calendar-grid" id="calendarWeekdays">
                  </div>
              <div class="calendar-grid" id="calendarDays">
                  </div>
            </div>
            <div class="event-list">
                <h3 class="widget-title" style="margin-left:1rem;">Eventos del mes</h3>
                <div class="event-item">
                    <div class="event-title">Webinar: IA en Finanzas</div>
                    <div class="event-time">üìÖ 25 de Octubre, 10:00 AM</div>
                </div>
                 <div class="event-item">
                    <div class="event-title">Taller: Automatizaci√≥n con Power Automate</div>
                    <div class="event-time">üìÖ 29 de Octubre, 15:00 PM</div>
                </div>
            </div>
        </div>
        <div id="profile-pane" class="page-pane" style="display:none">
            <div class="placeholder-pane">
                <span class="placeholder-icon">üë§</span>
                <h2 class="placeholder-title">Mi Perfil</h2>
                <p class="placeholder-text">Aqu√≠ podr√°s ver tu informaci√≥n, cambiar tu avatar y gestionar tus preferencias de notificaci√≥n.</p>
            </div>
        </div>

      </div>
      <div class="main-right">
        <div class="widget-cta-box">
          <div class="widget-cta-title">üöÄ ¬øListo para empezar?</div>
          <div class="widget-cta-desc">Completa tu primer curso de "Introducci√≥n a la IA" y gana 50 puntos.</div>
          <button class="widget-btn" onclick="nav('academy')">Ir a Cursos</button>
        </div>

        <div class="widget">
            <div class="widget-title">üîî Lo m√°s reciente</div>
            <div class="event-list" style="margin-top:0; border:none; padding:0;">
                <div class="event-item" style="padding: 0.8rem; border-left-width: 3px;">
                    <div class="event-title" style="font-size:0.9rem;">Nuevo curso: Copilot Avanzado</div>
                    <div class="event-time" style="font-size:0.8rem;">Hace 2 horas</div>
                </div>
                 <div class="event-item" style="padding: 0.8rem; border-left-width: 3px; border-left-color: var(--mint);">
                    <div class="event-title" style="font-size:0.9rem;">Nueva Herramienta: Generador de Im√°genes</div>
                    <div class="event-time" style="font-size:0.8rem;">Hace 5 horas</div>
                </div>
            </div>
        </div>
        
        <div class="widget">
          <div class="widget-title">üèÜ Mis Logros</div>
          <div class="badges-container" id="badgesContainer">
            </div>
        </div>
        
        <div class="widget">
          <div class="widget-title">üîó Enlaces R√°pidos</div>
          <ul class="widget-list">
            <li><a href="#" onclick="nav('tools')">Herramientas IA Aprobadas</a></li>
            <li><a href="#" onclick="nav('academy')">Rutas de Formaci√≥n</a></li>
            <li><a href="#" onclick="nav('calendar')">Pr√≥ximos Webinars</a></li>
            <li><a href="#">Soporte Digital</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <button class="chat-fab" id="chatFab" title="Asistente IA">
    <span>üí¨</span>
  </button>
  <div class="chat-window" id="chatWindow">
      <div class="chat-header">
          <h3>Asistente IA</h3>
          <button class="chat-close" id="chatClose">√ó</button>
      </div>
      <div class="chat-messages" id="chatMessages">
          <div class="chat-message bot">
              ¬°Hola! Soy tu asistente de InnovateHub. ¬øEn qu√© puedo ayudarte hoy?
          </div>
      </div>
      <div class="chat-input-container">
          <input type="text" class="chat-input" id="chatInput" placeholder="Escribe tu pregunta...">
          <button class="chat-send" id="chatSend">
            <span>‚û§</span>
          </button>
      </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- SELECTORES DE ELEMENTOS ---
    const themeToggle = document.getElementById('themeToggle');
    const themeIcon = document.getElementById('themeIcon');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const toastContainer = document.getElementById('toastContainer');
    const chatFab = document.getElementById('chatFab');
    const chatWindow = document.getElementById('chatWindow');
    const chatClose = document.getElementById('chatClose');
    const chatMessages = document.getElementById('chatMessages');
    const chatInput = document.getElementById('chatInput');
    const chatSend = document.getElementById('chatSend');
    const mainModal = document.getElementById('mainModal');
    const notificationButton = document.getElementById('notificationButton');
    const mainSearch = document.getElementById('mainSearch');
    const searchSuggestions = document.getElementById('searchSuggestions');
    const topnavTitle = document.getElementById('topnavTitle');
    const filterContainer = document.getElementById('filterContainer');
    const homeNewsList = document.getElementById('homeNewsList');
    const allNewsList = document.getElementById('allNewsList');
    const favCountBadge = document.getElementById('favCount');
    const notificationBadge = document.getElementById('notificationBadge');
    const notifDot = document.getElementById('notifDot');
    
    let currentFavorites = 0;
    let currentNotifications = 2; // Simulado

    // --- DATOS SIMULADOS (MOCK DATA) ---
    // En una app real, esto vendr√≠a de tu backend/API
    
    // (#3, #6, #10) Datos para Dashboard, Gamificaci√≥n y Analytics
    const mockUserData = {
        name: "Usuario Ejemplo",
        initials: "UE",
        points: 450,
        pointsGoal: 1000,
        coursesCompleted: 3,
        coursesGoal: 10,
        hoursLearning: 12,
        hoursGoal: 50,
        streak: 4,
        badges: [
            { id: 1, icon: "üéì", name: "Aprendiz", desc: "Completa tu primer curso", locked: false },
            { id: 2, icon: "ü§ñ", name: "Explorador IA", desc: "Prueba 3 herramientas IA", locked: false },
            { id: 3, icon: "üî•", name: "En racha", desc: "Activo 3 d√≠as seguidos", locked: false },
            { id: 4, icon: "üì∞", name: "Curioso", desc: "Lee 10 noticias", locked: true },
            { id: 5, icon: "‚≠ê", name: "Coleccionista", desc: "Guarda 5 favoritos", locked: true },
        ],
        analytics: [
            { day: "Lun", value: 30 },
            { day: "Mar", value: 45 },
            { day: "Mi√©", value: 20 },
            { day: "Jue", value: 75 },
            { day: "Vie", value: 60 },
            { day: "S√°b", value: 0 },
            { day: "Dom", value: 15 },
        ]
    };
    
    // (#1) Datos para Noticias
    const mockNewsData = [
        { id: 1, title: "La IA Generativa revoluciona el marketing", desc: "Nuevos modelos...", badge: "IA", img: "https://images.unsplash.com/photo-1684493735679-359868df0e18?q=80&w=200" },
        { id: 2, title: "Espa√±a lidera la adopci√≥n digital en PYMES", desc: "Informe de la UE...", badge: "ESPA√ëA", img: "https://images.unsplash.com/photo-1542744173-8e7e53415bb0?q=80&w=200" },
        { id: 3, title: "Sostenibilidad y Tecnolog√≠a: El futuro", desc: "C√≥mo la digitalizaci√≥n...", badge: "Sostenibilidad", img: "https://images.unsplash.com/photo-1488229297570-58520851e868?q=80&w=200" },
        { id: 4, title: "Nuevas herramientas de Copilot", desc: "Microsoft anuncia...", badge: "IA", img: "https://images.unsplash.com/photo-1507208773393-40d9fc670c58?q=80&w=200" },
        { id: 5, title: "El Kit Digital impulsa a 10.000 pymes", desc: "Resultados del programa...", badge: "PYMES", img: "https://images.unsplash.com/photo-1556761175-5973dc0f32e7?q=80&w=200" },
        { id: 6, title: "Ciberseguridad en la era de la IA", desc: "Nuevos desaf√≠os...", badge: "Seguridad", img: "https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5?q=80&w=200" }
    ];

    // (#4) Datos para Buscador
    const mockSearchTerms = [
        "Cursos de IA", "Qu√© es Copilot", "Noticias de Espa√±a", "Herramienta para crear im√°genes", "Calendario de webinars", "Progreso de mi dashboard"
    ];

    // --- 1. N√öCLEO: SISTEMA DE NAVEGACI√ìN ---
    // Funci√≥n principal que controla qu√© panel se muestra
    window.nav = (paneId) => {
        // Ocultar todos los paneles
        document.querySelectorAll('.page-pane').forEach(pane => {
            pane.style.display = 'none';
        });
        
        // Mostrar el panel solicitado
        const targetPane = document.getElementById(paneId + '-pane');
        if (targetPane) {
            targetPane.style.display = 'block';
        }

        // Actualizar bot√≥n activo en la sidebar
        document.querySelectorAll('.side-menu button').forEach(btn => {
            btn.classList.remove('active');
        });
        const targetButton = document.getElementById('btn-' + paneId);
        if (targetButton) {
            targetButton.classList.add('active');
        }

        // Actualizar t√≠tulo del Topnav
        const titles = {
            home: "Inicio",
            dashboard: "Mi Progreso",
            academy: "Academia",
            tools: "Herramientas IA",
            news: "Noticias",
            favorites: "Mis Guardados",
            calendar: "Calendario",
            profile: "Mi Perfil"
        };
        topnavTitle.textContent = titles[paneId] || "InnovateHub";

        // (#4) Mostrar/ocultar filtros de b√∫squeda
        if (paneId === 'news') {
            filterContainer.style.display = 'flex';
        } else {
            filterContainer.style.display = 'none';
        }
    };
    
    // --- 2. SISTEMA DE NOTIFICACIONES (#2) ---
    // Toast (notificaci√≥n emergente)
    window.showToast = (message, type = 'success', title = '¬°Hecho!') => {
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        
        const icons = {
            success: '‚úÖ',
            error: '‚ùå',
            warning: '‚ö†Ô∏è'
        };

        toast.innerHTML = `
            <div class="toast-icon">${icons[type]}</div>
            <div class="toast-content">
                <div class="toast-title">${title}</div>
                <div class="toast-message">${message}</div>
            </div>
            <button class="toast-close">√ó</button>
        `;

        toast.querySelector('.toast-close').onclick = () => {
            toast.classList.add('fadeOut');
            setTimeout(() => toast.remove(), 500);
        };
        
        toastContainer.appendChild(toast);
        
        setTimeout(() => {
            toast.classList.add('fadeOut');
            setTimeout(() => toast.remove(), 500);
        }, 3000);
    };

    // Modal (para notificaciones principales)
    window.openModal = (title, content) => {
        document.getElementById('modalTitle').innerHTML = title;
        document.getElementById('modalBody').innerHTML = content;
        mainModal.classList.add('open');
    };
    
    window.closeModal = () => {
        mainModal.classList.remove('open');
    };
    
    // L√≥gica del bot√≥n de notificaciones
    notificationButton.onclick = () => {
        openModal('Notificaciones', `
            <div class="event-item" style="border-left-color: var(--success);">
                <div class="event-title">¬°Nuevo curso disponible!</div>
                <div class="event-time">Introducci√≥n a la IA Generativa.</div>
            </div>
            <div class="event-item" style="border-left-color: var(--warning);">
                <div class="event-title">Webinar Ma√±ana</div>
                <div class="event-time">Taller de Copilot - 10:00 AM.</div>
            </div>
            <div class="event-item" style="border-left-color: var(--danger);">
                <div class="event-title">Actualizaci√≥n de Seguridad</div>
                <div class="event-time">Requerida nueva contrase√±a.</div>
            </div>
        `);
        // Ocultar badges al abrir
        notificationBadge.style.display = 'none';
        notifDot.style.display = 'none';
        currentNotifications = 0;
    };
    
    // Actualizar badges de notificaci√≥n (simulaci√≥n)
    const updateNotificationBadges = () => {
        if (currentNotifications > 0) {
            notificationBadge.textContent = currentNotifications;
            notificationBadge.style.display = 'flex';
            notifDot.style.display = 'block';
        }
    };

    // --- 3. MODO OSCURO (#9) ---
    window.toggleTheme = () => {
        const currentTheme = document.documentElement.dataset.theme;
        if (currentTheme === 'dark') {
            document.documentElement.dataset.theme = 'light';
            themeIcon.textContent = 'üåô';
            localStorage.setItem('theme', 'light');
        } else {
            document.documentElement.dataset.theme = 'dark';
            themeIcon.textContent = '‚òÄÔ∏è';
            localStorage.setItem('theme', 'dark');
        }
    };

    const loadTheme = () => {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.documentElement.dataset.theme = 'dark';
            themeIcon.textContent = '‚òÄÔ∏è';
        } else {
            document.documentElement.dataset.theme = 'light';
            themeIcon.textContent = 'üåô';
        }
    };
    
    // --- 4. CHAT ASISTENTE IA (#8) ---
    window.toggleChat = () => {
        chatWindow.classList.toggle('open');
    };

    const addChatMessage = (message, sender) => {
        const msgDiv = document.createElement('div');
        msgDiv.className = `chat-message ${sender}`;
        msgDiv.innerHTML = message; // Usar innerHTML para el "thinking"
        chatMessages.appendChild(msgDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
        return msgDiv; // Devolver el div para poder eliminarlo (para el "thinking")
    };

    const handleChatSend = () => {
        const userMessage = chatInput.value.trim();
        if (!userMessage) return;

        addChatMessage(userMessage, 'user');
        chatInput.value = '';

        // Simular respuesta del Bot
        const thinkingMsg = addChatMessage(`
            <span class="thinking-dot"></span>
            <span class="thinking-dot"></span>
            <span class="thinking-dot"></span>
        `, 'bot thinking');
        
        setTimeout(() => {
            thinkingMsg.remove(); // Eliminar el "thinking"
            
            // Aqu√≠ ir√≠a tu llamada real a la API de Claude
            // fetch('https://api.anthropic.com/v1/messages', { ... })
            // .then(response => response.json())
            // .then(data => {
            //    addChatMessage(data.completion.text, 'bot');
            // });

            // Respuesta simulada:
            let botResponse = "Lo siento, no entiendo esa pregunta. Intenta preguntar sobre cursos de IA, herramientas o noticias.";
            if (userMessage.toLowerCase().includes("hola")) {
                botResponse = "¬°Hola! ¬øC√≥mo puedo ayudarte con tu formaci√≥n digital hoy?";
            } else if (userMessage.toLowerCase().includes("curso")) {
                botResponse = "Tenemos varios cursos de IA. Te recomiendo empezar por 'Introducci√≥n a la IA Generativa'. Puedes encontrarlo en la secci√≥n üéì Academia.";
            } else if (userMessage.toLowerCase().includes("noticias")) {
                botResponse = "Puedes ver las √∫ltimas noticias en la secci√≥n üì∞ Noticias. Acabamos de publicar un art√≠culo sobre PYMES.";
            }
            
            addChatMessage(botResponse, 'bot');

        }, 1500);
    };

    // --- 5. NOTICIAS AUTOM√ÅTICAS (#1) y FAVORITOS (#5) ---
    const showLoading = (show) => {
        loadingOverlay.style.display = show ? 'flex' : 'none';
    };

    const renderNews = (data, container) => {
        container.innerHTML = ''; // Limpiar lista
        data.forEach(news => {
            const card = document.createElement('div');
            card.className = 'news-card';
            card.innerHTML = `
                <img class="news-card-image" src="${news.img}" alt="${news.title}"/>
                <div class="news-card-main">
                    <div class="news-card-badge" style="background:${news.badge === 'IA' ? 'var(--badge)' : 'var(--purple)'}">${news.badge}</div>
                    <div class="news-card-title">${news.title}</div>
                </div>
                <button class="fav-btn" data-id="${news.id}" title="Guardar">
                    <span>‚≠ê</span>
                </button>
            `;
            // Abrir noticia (simulado)
            card.addEventListener('click', (e) => {
                if (e.target.closest('.fav-btn')) return; // No abrir si se clica en favorito
                openModal(news.title, `<img src="${news.img}" style="width:100%; border-radius:10px; margin-bottom:1rem;"/><p>${news.desc}</p><a href="#" class="widget-btn" style="margin:0;">Leer m√°s</a>`);
            });
            
            // (#5) Event Listener para el bot√≥n de favorito
            card.querySelector('.fav-btn').addEventListener('click', toggleFavorite);
            
            container.appendChild(card);
        });
    };
    
    // (#5) L√≥gica de Favoritos
    const toggleFavorite = (e) => {
        e.stopPropagation(); // Evitar que se abra el modal de la noticia
        const btn = e.currentTarget;
        btn.classList.toggle('active');
        
        if (btn.classList.contains('active')) {
            showToast('A√±adido a favoritos', 'success');
            currentFavorites++;
        } else {
            showToast('Eliminado de favoritos', 'warning', '¬°Oops!');
            currentFavorites--;
        }
        
        // Actualizar contador
        favCountBadge.textContent = currentFavorites;
        favCountBadge.style.display = currentFavorites > 0 ? 'flex' : 'none';
    };

    // (#1) Simulaci√≥n de "fetch" de noticias
    const fetchNews = (filter = 'all') => {
        showLoading(true);
        const btn = document.getElementById('refreshNewsBig');
        if (btn) btn.classList.add('loading');
        
        // Simular llamada a API (1 segundo)
        setTimeout(() => {
            // Aqu√≠ har√≠as la llamada real:
            // fetch('https://api.newsapi.org/v2/everything?q=IA&apiKey=...')
            // .then(res => res.json())
            // .then(data => { ... })
            
            let filteredNews = mockNewsData;
            
            // (#4) L√≥gica de Filtros
            if (filter !== 'all') {
                filteredNews = mockNewsData.filter(news => news.badge.toUpperCase() === filter.toUpperCase());
            }

            // Renderizar noticias en los dos listados
            renderNews(filteredNews.slice(0, 4), homeNewsList); // Solo 4 en Home
            renderNews(filteredNews, allNewsList); // Todas en la p√°g. de Noticias
            
            showLoading(false);
            if (btn) btn.classList.remove('loading');
            showToast('Noticias actualizadas', 'success');

        }, 1000);
    };
    
    // Filtros de noticias (#4)
    filterContainer.addEventListener('click', (e) => {
        if (e.target.classList.contains('filter-btn')) {
            // Quitar 'active' a todos
            filterContainer.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            // A√±adir 'active' al clicado
            e.target.classList.add('active');
            // Volver a "fetchear" noticias con el filtro
            const filter = e.target.dataset.filter;
            fetchNews(filter);
        }
    });
    
    document.getElementById('refreshNewsBig').addEventListener('click', () => fetchNews());


    // --- 6. BUSCADOR MEJORADO (#4) ---
    mainSearch.addEventListener('input', () => {
        const query = mainSearch.value.toLowerCase();
        if (query.length < 2) {
            searchSuggestions.classList.remove('active');
            return;
        }

        // Simulaci√≥n de b√∫squeda sem√°ntica (filtrado simple)
        const suggestions = mockSearchTerms.filter(term => term.toLowerCase().includes(query));
        
        if (suggestions.length > 0) {
            searchSuggestions.innerHTML = '';
            suggestions.forEach(term => {
                const item = document.createElement('div');
                item.className = 'suggestion-item';
                // Resaltar coincidencia
                item.innerHTML = term.replace(new RegExp(query, 'gi'), (match) => `<strong>${match}</strong>`);
                item.onclick = () => {
                    mainSearch.value = term;
                    searchSuggestions.classList.remove('active');
                    // Simular acci√≥n de b√∫squeda
                    showToast(`Resultados para "${term}"`, 'success');
                };
                searchSuggestions.appendChild(item);
            });
            searchSuggestions.classList.add('active');
        } else {
            searchSuggestions.classList.remove('active');
        }
    });
    // Ocultar sugerencias si se clica fuera
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.searchbar')) {
            searchSuggestions.classList.remove('active');
        }
    });

    // --- 7. DASHBOARD (#3), GAMIFICACI√ìN (#6), ANALYTICS (#10) ---
    const updateDashboard = () => {
        const data = mockUserData;
        
        // (#3) Dashboard de Progreso
        document.getElementById('totalPoints').textContent = data.points;
        document.getElementById('coursesCompleted').textContent = data.coursesCompleted;
        document.getElementById('hoursLearning').textContent = data.hoursLearning;
        document.getElementById('currentStreak').textContent = data.streak;

        // Barras de progreso
        document.getElementById('pointsBar').style.width = `${(data.points / data.pointsGoal) * 100}%`;
        document.getElementById('coursesBar').style.width = `${(data.coursesCompleted / data.coursesGoal) * 100}%`;
        document.getElementById('hoursBar').style.width = `${(data.hoursLearning / data.hoursGoal) * 100}%`;

        // (#10) Analytics Personal
        const chartContainer = document.getElementById('analyticsChart');
        chartContainer.innerHTML = '';
        const maxVal = Math.max(...data.analytics.map(d => d.value));
        
        data.analytics.forEach(day => {
            const bar = document.createElement('div');
            bar.className = 'chart-bar';
            bar.style.height = `${(day.value / maxVal) * 100}%`;
            bar.title = `${day.day}: ${day.value} min`;
            bar.innerHTML = `
                <span class="chart-bar-value">${day.value} min</span>
                <span class="chart-bar-label">${day.day}</span>
            `;
            chartContainer.appendChild(bar);
        });

        // (#6) Gamificaci√≥n (Widget de Logros)
        const badgesContainer = document.getElementById('badgesContainer');
        badgesContainer.innerHTML = '';
        data.badges.forEach(badge => {
            const badgeEl = document.createElement('div');
            badgeEl.className = `badge-item ${badge.locked ? 'locked' : ''}`;
            badgeEl.title = `${badge.name}: ${badge.desc}`;
            badgeEl.innerHTML = `
                <div class="badge-icon">${badge.icon}</div>
                <div class="badge-name">${badge.name}</div>
            `;
            badgesContainer.appendChild(badgeEl);
        });
    };
    
    // --- 8. CALENDARIO DE EVENTOS (#7) ---
    let calDate = new Date(); // Fecha actual para el calendario

    const renderCalendar = () => {
        calDate.setDate(1); // Empezar por el d√≠a 1 del mes
        const month = calDate.getMonth();
        const year = calDate.getFullYear();
        
        const firstDayIndex = calDate.getDay() === 0 ? 6 : calDate.getDay() - 1; // 0=Lunes, 6=Domingo
        const lastDayIndex = new Date(year, month + 1, 0).getDay() === 0 ? 6 : new Date(year, month + 1, 0).getDay() - 1;
        const lastDay = new Date(year, month + 1, 0).getDate(); // √öltimo d√≠a del mes
        const prevLastDay = new Date(year, month, 0).getDate(); // √öltimo d√≠a del mes anterior
        const nextDays = 7 - 1 - lastDayIndex; // D√≠as del mes sig. a mostrar

        const weekdays = ['Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b', 'Dom'];
        const months = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];

        document.getElementById('calendarTitle').textContent = `${months[month]} ${year}`;

        const weekdaysGrid = document.getElementById('calendarWeekdays');
        weekdaysGrid.innerHTML = '';
        weekdays.forEach(day => {
            weekdaysGrid.innerHTML += `<div class="calendar-day-header">${day}</div>`;
        });
        
        const daysGrid = document.getElementById('calendarDays');
        daysGrid.innerHTML = '';
        
        // D√≠as mes anterior
        for (let x = firstDayIndex; x > 0; x--) {
            daysGrid.innerHTML += `<div class="calendar-day empty">${prevLastDay - x + 1}</div>`;
        }

        // D√≠as mes actual
        const today = new Date();
        for (let i = 1; i <= lastDay; i++) {
            let classes = "calendar-day";
            if (i === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                classes += " today";
            }
            // Simular eventos
            if (i === 25 || i === 29) {
                classes += " has-event";
            }
            daysGrid.innerHTML += `<div class="${classes}">${i}</div>`;
        }
        
        // D√≠as mes siguiente
        for (let j = 1; j <= nextDays; j++) {
            daysGrid.innerHTML += `<div class="calendar-day empty">${j}</div>`;
        }
    };
    
    document.getElementById('calPrev').onclick = () => {
        calDate.setMonth(calDate.getMonth() - 1);
        renderCalendar();
    };
    
    document.getElementById('calNext').onclick = () => {
        calDate.setMonth(calDate.getMonth() + 1);
        renderCalendar();
    };

    // --- INICIALIZACI√ìN DE LA APP ---
    const init = () => {
        loadTheme();
        updateNotificationBadges();
        
        // Cargar datos iniciales
        fetchNews();
        updateDashboard();
        renderCalendar();

        // Asignar Event Listeners
        themeToggle.addEventListener('click', toggleTheme);
        chatFab.addEventListener('click', toggleChat);
        chatClose.addEventListener('click', toggleChat);
        chatSend.addEventListener('click', handleChatSend);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleChatSend();
        });
        
        // Clic en el avatar (ya est√° en el HTML, pero es buena pr√°ctica)
        document.getElementById('avatar').addEventListener('click', () => nav('profile'));
    };

    init(); // Ejecutar la app
});
</script>

</body>
</html>
